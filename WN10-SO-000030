WN10-SO-000030 - Audit policy using subcategories must be enabled.

# Enable Audit Policy Subcategories (Success and Failure)
Write-Host "Enabling Audit Policy Subcategories for Success and Failure..."

# Retrieve all audit policy subcategories
$categories = auditpol /get /category:* | Select-String "Category Name" | ForEach-Object { ($_ -split ':')[-1].Trim() }

# Apply audit policy settings to each category
foreach ($category in $categories) {
    Write-Host "Configuring audit policy for: $category"
    auditpol /set /category:"$category" /success:enable /failure:enable
}

# Verify the changes
Write-Host "Verifying configured audit policies..."
auditpol /get /category:* | Format-Table -AutoSize

Write-Host "Audit Policy Subcategories have been successfully enabled!"
