WN10-00-000031 - Windows 10 systems must use a BitLocker PIN for pre-boot authentication.


# Enforce BitLocker PIN for Pre-Boot Authentication
Write-Host "Enforcing BitLocker PIN for Pre-Boot Authentication..."

# Define the registry path and value
$regPath = "HKLM:\SOFTWARE\Policies\Microsoft\FVE"
$regValueName = "UseTPMPIN"
$regValueData = 1

# Check if the registry path exists
if (!(Test-Path $regPath)) {
    Write-Host "Creating registry path: $regPath"
    New-Item -Path $regPath -Force
}

# Set the registry value to enforce BitLocker PIN
Set-ItemProperty -Path $regPath -Name $regValueName -Value $regValueData -Type DWord
Write-Host "Registry setting applied: UseTPMPIN = 1"

# Enable BitLocker with TPM and PIN requirement
Write-Host "Configuring BitLocker to require a PIN..."
Enable-BitLocker -MountPoint "C:" -EncryptionMethod AES256 -TpmAndPinProtector -Pin (Read-Host "Enter a new BitLocker PIN (6+ digits)" -AsSecureString)

# Verify BitLocker status
Write-Host "Verifying BitLocker status..."
Get-BitLockerVolume | Format-Table -AutoSize

Write-Host "BitLocker PIN enforcement is complete!"
